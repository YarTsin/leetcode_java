package org.example.g1401_1500.s1475_final_prices_with_a_special_discount_in_a_shop;

// #Easy #Array #Stack #Monotonic_Stack #ArrayDeque

import java.util.Stack;

/**
 * 1475. Final Prices With a Special Discount in a Shop
 *
 * Дан массив целых чисел prices, где prices[i]  — это исходная
 * цена i-го товара в магазине.
 *
 * Существует специальная скидка: если вы покупаете i-й товар,
 * то вы получаете скидку, равную цене первого следующего товара
 * (т.е. товара с индексом j > i), такого что prices[j] <= prices[i].
 * Если такого товара нет, скидка не применяется.
 *
 * Необходимо вернуть массив, где для каждого товара указана окончательная
 * цена после применения скидки.
 *
 * todo запутанные условия
 * (примеры внизу)
 *
 * Решение: Использование стека (Monotonic Stack)
 * Не быстрое решение - 3 ms
 *
 * Подход:
 * Используем стек для хранения индексов элементов.
 * Проходим по массиву и для каждого элемента проверяем,
 * можно ли применить скидку для элементов в стеке.
 *
 * Сложность: O(n) по времени, O(n) по памяти
 *
 */
class Solution {
    public int[] finalPrices(int[] prices) {
        int n = prices.length;
        int[] result = new int[n];
        Stack<Integer> stack = new Stack<>();

        // Копируем исходные цены в результат
        System.arraycopy(prices, 0, result, 0, n);

        for (int i = 0; i < n; i++) {
            // Пока стек не пуст и текущая цена <= цене элемента из стека
            while (!stack.isEmpty() && prices[i] <= prices[stack.peek()]) {
                int index = stack.pop();
                result[index] = prices[index] - prices[i];
            }
            stack.push(i);
        }

        return result;
    }
}
/*
Пример 1
Входные данные: prices = [8,4,6,2,3]
Выходные данные: [4,2,4,2,3]
Объяснение:
- Товар 0: цена 8, следующий товар с ценой <= 8 - это товар 1 (цена 4)
  Итоговая цена: 8 - 4 = 4
- Товар 1: цена 4, следующий товар с ценой <= 4 - это товар 3 (цена 2)
  Итоговая цена: 4 - 2 = 2
- Товар 2: цена 6, следующий товар с ценой <= 6 - это товар 3 (цена 2)
  Итоговая цена: 6 - 2 = 4
- Товар 3: цена 2, нет следующего товара с ценой <= 2
  Итоговая цена: 2
- Товар 4: цена 3, нет следующего товара
  Итоговая цена: 3

Пример 2
Входные данные: prices = [1,2,3,4,5]
Выходные данные: [1,2,3,4,5]
Объяснение:
Ни для одного товара нет следующего товара с меньшей или равной ценой,
поэтому скидки не применяются.

Пример 3
Входные данные: prices = [10,1,1,6]
Выходные данные: [9,0,1,6]
Объяснение:
- Товар 0: цена 10, следующий товар с ценой <= 10 - товар 1 (цена 1)
  Итоговая цена: 10 - 1 = 9
- Товар 1: цена 1, следующий товар с ценой <= 1 - товар 2 (цена 1)
  Итоговая цена: 1 - 1 = 0
- Товар 2: цена 1, нет следующего товара с ценой <= 1
  Итоговая цена: 1
- Товар 3: цена 6, нет следующего товара
  Итоговая цена: 6

 */

